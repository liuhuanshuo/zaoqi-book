#!/usr/bin/env python
# coding: utf-8

# # é‡å¤å€¼æ£€æŸ¥ä¸å¤„ç†

# ```{admonition} åœ¨çº¿åˆ·é¢˜
# :class: seealso
# 
# æ£€æŸ¥ or å¼ºåŒ– `Pandas` æ•°æ®åˆ†ææ“ä½œï¼Ÿ<a href="https://www.heywhale.com/mw/project/6146c0318447b8001769ff20" target="_blank">ğŸ‘‰åœ¨çº¿ä½“éªŒã€ŒPandasè¿›é˜¶ä¿®ç‚¼300é¢˜ã€</a>
# ```

# ```{note} 
# æœ¬é¡µé¢ä»£ç å¯ä»¥[åœ¨çº¿ç¼–è¾‘ã€æ‰§è¡Œ](../æŒ‡å¼•/åœ¨çº¿æ‰§è¡Œ.md)ï¼
# ```

# In[1]:


import pandas as pd
df = pd.read_excel("TOP250.xlsx")
pd.set_option('display.max_colwidth',10)


# ## æŸ¥æ‰¾å…¨éƒ¨é‡å¤å€¼
# 
# 
# å°†å…¨éƒ¨ç¼ºå¤±å€¼æ‰€åœ¨çš„è¡Œç­›é€‰å‡ºæ¥

# In[2]:


df[df.duplicated()]


# ## æŸ¥æ‰¾æŒ‡å®šåˆ—é‡å¤å€¼
# 
# ä¸Šé¢æ˜¯æ‰€æœ‰åˆ—å®Œå…¨é‡å¤çš„æƒ…å†µï¼Œä½†æœ‰æ—¶æˆ‘ä»¬åªéœ€è¦æ ¹æ®æŸåˆ—æŸ¥æ‰¾ç¼ºå¤±å€¼
# 
# -> æŸ¥æ‰¾ ç‰‡å åˆ—å…¨éƒ¨ç¼ºå¤±å€¼

# In[3]:


df[df.duplicated(['ç‰‡å'])]


# ## åˆ é™¤å…¨éƒ¨é‡å¤å€¼
# 
# åˆ é™¤å…¨éƒ¨çš„é‡å¤å€¼

# In[4]:


df = df.drop_duplicates()


# ## ä¿ç•™é‡å¤å€¼
# 
# åˆ é™¤å…¨éƒ¨çš„é‡å¤å€¼ï¼Œä½†ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„å€¼

# In[5]:


df = df.drop_duplicates(keep = 'last')

